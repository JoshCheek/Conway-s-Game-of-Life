#!/usr/bin/env ruby -s
# this script is intended to be invoked via game_of_life

# make our lib accessible and load game of life code
$: << File.dirname(__FILE__) + '/../lib'
require 'game_of_life'

# create the board, using the seed that was passed in
x_offset , y_offset = 5 , 5
$seed ||= '[0,0],[3,0],[4,1],[0,2],[4,2],[1,3],[2,3],[3,3],[4,3]'
$seed = eval "[#$seed]"
$seed.map! { |(x,y)| [ x+x_offset , y+y_offset ] }
board = GameOfLife.new(*$seed)

# set the dimensions using the seed that was passed in
# or use the board's defaults
$dimensions ||= "#{board.width},#{board.height}"
board.width , board.height = eval "[#$dimensions]"

system 'clear'

# go to upper left and print the game out
loop do
  print "\e[0;0H"
  puts board.to_a.map { |row| row.map { |element| element ? 'X' : ' ' }.join }.join("\n")
  board.tick!
  sleep 0.1
end